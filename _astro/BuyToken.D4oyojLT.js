/* empty css                                   */import{d as x,g as c,o as d,h as k,w as y,a as f,c as h,F as w,r as C,m as V,T as W,i as E,S as D,b,t as _,u as R,j as P,f as A}from"./solana-wallets-vue.BQV4QrwB.js";import{x as N,w as O,g as F,b as K,C as M,c as j,B as L}from"./index.CTG0OxZE.js";import{u as U,$ as G,c as H}from"./stream.BfcqwEDI.js";import{_ as I,I as q,c as z,s as J,a as Q,b as X,C as g,d as v}from"./_plugin-vue_export-helper.ByfqkwuR.js";import{b as Y}from"./index.pj2VwCcK.js";import{g as B,c as T,T as Z}from"./associatedTokenAccount.dS-F_M_j.js";const $=x({__name:"Slider",props:{name:{},defaultValue:{},modelValue:{},disabled:{type:Boolean},orientation:{},dir:{},inverted:{type:Boolean},min:{},max:{},step:{},minStepsBetweenThumbs:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","valueCommit"],setup(r,{expose:i,emit:n}){i();const e=r,o=n,a=c(()=>{const{class:S,...u}=e;return u}),t=N(a,o),s={props:e,emits:o,delegatedProps:a,forwarded:t,get SliderRange(){return O},get SliderRoot(){return F},get SliderThumb(){return K},get SliderTrack(){return M},get cn(){return j}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}});function ee(r,i,n,e,o,a){return d(),k(e.SliderRoot,V({class:e.cn("relative flex w-full touch-none select-none items-center",e.props.class)},e.forwarded),{default:y(()=>[f(e.SliderTrack,{class:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary"},{default:y(()=>[f(e.SliderRange,{class:"absolute h-full bg-primary"})]),_:1}),(d(!0),h(w,null,C(n.modelValue,(t,s)=>(d(),k(e.SliderThumb,{key:s,class:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}))),128))]),_:1},16,["class"])}const te=I($,[["render",ee]]);async function re(r,i,n){const e=B(v,r),o=B(g,r);let a=Y.Buffer.alloc(17),t=0;t=a.writeUint8(q.Buy,t),t=a.writeBigInt64LE(BigInt(i),t),t=a.writeBigInt64LE(BigInt(n),t);const s=new W;return s.feePayer=r,s.add(T(r,e,r,v),T(r,o,r,g),new E({programId:z,keys:[{pubkey:J.publicKey,isWritable:!0,isSigner:!1},{pubkey:Q,isWritable:!0,isSigner:!1},{pubkey:X,isWritable:!0,isSigner:!1},{pubkey:r,isWritable:!0,isSigner:!0},{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:g,isWritable:!0,isSigner:!1},{pubkey:o,isWritable:!0,isSigner:!1},{pubkey:Z,isWritable:!1,isSigner:!1},{pubkey:D.programId,isWritable:!1,isSigner:!1}],data:a})),s}const ne=x({__name:"BuyToken",setup(r,{expose:i}){i();const n=R(),e=U(G),o=c(()=>{if(e.value){const l=e.value.seller,p=l.target_value_in_sol,m=l.token_to_sell_amount-l.token_selled_amount;return p/m}else return 0}),a=P([1]),t=c(()=>{let l=a.value[0];return Math.max(.01,l)}),s=c(()=>o.value>0?t.value/o.value:0);async function S(){const l=n.publicKey.value;if(l||(await n.connect(),console.log("没有选择钱包")),l){const p=s.value*1e9*.95|0,m=await re(n.publicKey.value,t.value*1e9,p);await n.sendTransaction(m,H.value)}}const u={wallet:n,state:e,price:o,inputSolSliderValue:a,inputSol:t,to_get_token_amount:s,buy_token:S,get Button(){return L},get Slider(){return te}};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),ae={class:"w-60"};function oe(r,i,n,e,o,a){return d(),h(w,null,[b("div",null,"token单价 "+_(e.price)+" sol per token",1),b("div",ae,[f(e.Slider,{"default-value":[1],max:1,step:.01,modelValue:e.inputSolSliderValue,"onUpdate:modelValue":i[0]||(i[0]=t=>e.inputSolSliderValue=t)},null,8,["modelValue"])]),b("div",null,"你将花费 "+_(e.inputSol)+" sol 以获取 "+_(e.to_get_token_amount)+" token",1),f(e.Button,{onClick:e.buy_token},{default:y(()=>[A("购买")]),_:1})],64)}const pe=I(ne,[["render",oe]]);export{pe as default};
