import{a9 as b,K as V,b as Y,C as J,h as X}from"./index.browser.esm.C04gqCef.js";import{c as ee,_ as E,E as G,S as te,a as re,O as L,e as A,b as ne,d as oe,p as ie,f as ae,o as j,m as se,g as ue,h as W,i as K,j as H,k,l as x,t as le,n as ce,u as fe,q as z,B as de,U as p,F as U,r as N,s as M,v as T,w as pe,x as ve}from"./binary-layout.BLjuCEjP.js";import{q as he,u as _e}from"./solana-wallets-vue.iHxXV6Bo.js";var be=ee(function(o){return function(){o(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),S=function(o){E(r,o);function r(){var t=o.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r.prototype.lift=function(t){var e=new B(this,this);return e.operator=t,e},r.prototype._throwIfClosed=function(){if(this.closed)throw new be},r.prototype.next=function(t){var e=this;A(function(){var n,i;if(e._throwIfClosed(),!e.isStopped){e.currentObservers||(e.currentObservers=Array.from(e.observers));try{for(var s=ne(e.currentObservers),a=s.next();!a.done;a=s.next()){var u=a.value;u.next(t)}}catch(f){n={error:f}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}})},r.prototype.error=function(t){var e=this;A(function(){if(e._throwIfClosed(),!e.isStopped){e.hasError=e.isStopped=!0,e.thrownError=t;for(var n=e.observers;n.length;)n.shift().error(t)}})},r.prototype.complete=function(){var t=this;A(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}})},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(t){return this._throwIfClosed(),o.prototype._trySubscribe.call(this,t)},r.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},r.prototype._innerSubscribe=function(t){var e=this,n=this,i=n.hasError,s=n.isStopped,a=n.observers;return i||s?G:(this.currentObservers=null,a.push(t),new te(function(){e.currentObservers=null,re(a,t)}))},r.prototype._checkFinalizedStatuses=function(t){var e=this,n=e.hasError,i=e.thrownError,s=e.isStopped;n?t.error(i):s&&t.complete()},r.prototype.asObservable=function(){var t=new L;return t.source=this,t},r.create=function(t,e){return new B(t,e)},r}(L),B=function(o){E(r,o);function r(t,e){var n=o.call(this)||this;return n.destination=t,n.source=e,n}return r.prototype.next=function(t){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.next)===null||n===void 0||n.call(e,t)},r.prototype.error=function(t){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.error)===null||n===void 0||n.call(e,t)},r.prototype.complete=function(){var t,e;(e=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||e===void 0||e.call(t)},r.prototype._subscribe=function(t){var e,n;return(n=(e=this.source)===null||e===void 0?void 0:e.subscribe(t))!==null&&n!==void 0?n:G},r}(S),P=function(o){E(r,o);function r(t){var e=o.call(this)||this;return e._value=t,e}return Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),r.prototype._subscribe=function(t){var e=o.prototype._subscribe.call(this,t);return!e.closed&&t.next(this._value),e},r.prototype.getValue=function(){var t=this,e=t.hasError,n=t.thrownError,i=t._value;if(e)throw n;return this._throwIfClosed(),i},r.prototype.next=function(t){o.prototype.next.call(this,this._value=t)},r}(S),me=function(o){E(r,o);function r(t,e,n){t===void 0&&(t=1/0),e===void 0&&(e=1/0),n===void 0&&(n=oe);var i=o.call(this)||this;return i._bufferSize=t,i._windowTime=e,i._timestampProvider=n,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=e===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,e),i}return r.prototype.next=function(t){var e=this,n=e.isStopped,i=e._buffer,s=e._infiniteTimeWindow,a=e._timestampProvider,u=e._windowTime;n||(i.push(t),!s&&i.push(a.now()+u)),this._trimBuffer(),o.prototype.next.call(this,t)},r.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var e=this._innerSubscribe(t),n=this,i=n._infiniteTimeWindow,s=n._buffer,a=s.slice(),u=0;u<a.length&&!t.closed;u+=i?1:2)t.next(a[u]);return this._checkFinalizedStatuses(t),e},r.prototype._trimBuffer=function(){var t=this,e=t._bufferSize,n=t._timestampProvider,i=t._buffer,s=t._infiniteTimeWindow,a=(s?1:2)*e;if(e<1/0&&a<i.length&&i.splice(0,i.length-a),!s){for(var u=n.now(),f=0,c=1;c<i.length&&i[c]<=u;c+=2)f=c;f&&i.splice(0,f+1)}},r}(S),we=Array.isArray;function ye(o){return o.length===1&&we(o[0])?o[0]:o}function Se(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];var t=ie(o),e=ae(o,1/0);return o=ye(o),j(function(n,i){se(e)(ue(W([n],K(o)),t)).subscribe(i)})}function ge(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return Se.apply(void 0,W([],K(o)))}function Ce(o){o===void 0&&(o={});var r=o.connector,t=r===void 0?function(){return new S}:r,e=o.resetOnError,n=e===void 0?!0:e,i=o.resetOnComplete,s=i===void 0?!0:i,a=o.resetOnRefCountZero,u=a===void 0?!0:a;return function(f){var c,l,v,m=0,w=!1,h=!1,_=function(){l?.unsubscribe(),l=void 0},d=function(){_(),c=v=void 0,w=h=!1},$=function(){var y=c;d(),y?.unsubscribe()};return j(function(y,F){m++,!h&&!w&&_();var g=v=v??t();F.add(function(){m--,m===0&&!h&&!w&&(l=I($,u))}),g.subscribe(F),!c&&m>0&&(c=new H({next:function(C){return g.next(C)},error:function(C){h=!0,_(),l=I(d,n,C),g.error(C)},complete:function(){w=!0,_(),l=I(d,s),g.complete()}}),k(y).subscribe(c))})(f)}}function I(o,r){for(var t=[],e=2;e<arguments.length;e++)t[e-2]=arguments[e];if(r===!0){o();return}if(r!==!1){var n=new H({next:function(){n.unsubscribe(),o()}});return k(r.apply(void 0,W([],K(t)))).subscribe(n)}}function q(o,r,t){var e,n=!1;return e=o,Ce({connector:function(){return new me(e,r,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:n})}function R(o,r){return j(function(t,e){var n=null,i=0,s=!1,a=function(){return s&&!n&&e.complete()};t.subscribe(x(e,function(u){n?.unsubscribe();var f=0,c=i++;k(o(u,c)).subscribe(n=x(e,function(l){return e.next(r?r(u,l,c,f++):l)},function(){n=null,a()}))},function(){s=!0,a()}))})}function xe(o,r){return j(function(t,e){var n=r??{},i=n.leading,s=i===void 0?!0:i,a=n.trailing,u=a===void 0?!1:a,f=!1,c=null,l=null,v=!1,m=function(){l?.unsubscribe(),l=null,u&&(_(),v&&e.complete())},w=function(){l=null,v&&e.complete()},h=function(d){return l=k(o(d)).subscribe(x(e,m,w))},_=function(){if(f){f=!1;var d=c;c=null,e.next(d),!v&&h(d)}};t.subscribe(x(e,function(d){f=!0,c=d,!(l&&!l.closed)&&(s?_():h(d))},function(){v=!0,!(u&&f&&l&&!l.closed)&&e.complete()}))})}function D(o,r,t){r===void 0&&(r=ce);var e=le(o,r);return xe(function(){return e},t)}new b("TTCGkEskz8Coj1U1UHuNnquQxtm9Cj4hzKvbF5HS6Hm");const Q=V.fromSecretKey(new Uint8Array([237,116,217,235,225,65,118,184,61,252,84,54,210,225,183,101,192,20,197,53,53,64,51,238,234,185,46,54,245,179,181,213,6,133,230,225,205,54,26,36,122,135,26,171,24,141,131,209,52,89,140,19,143,232,99,209,31,120,224,50,221,165,161,227]));new b("526SHGkpwYC5GK3NKMv4QSpAwCrFKjHbbnHs2kkHLus1");new b("HUPFcCmKZFLSyDzrYpJapDDbC5DCwkZkGevbozaEAJf5");new b("3WWrNLibTZsQqnGKNkn4NfKooSsGQGmPRtx5Wdj6BpA2");new b("99qQVnRs9juNhwmr7hcAuGRyYAf1HR6fNiUkFReJaGFD");new b("CCrd6FPk1zu5641ksm4SdXLDiHd2TRd6gSnZCXVrKrMr");new b("CShrvPhcbeLDgSteGgXwJPKDzLNQHbE4WykzSMdQGhYM");const Oe=new z([new p("expiring_time"),new p("max_sol_of_one_order"),new p("token_to_sell_amount"),new p("token_selled_amount"),new p("target_value_in_sol")],"seller"),Ee=new z([new U(32,"last_nonce"),new p("start_time"),new p("expiring_time"),new p("last_reward_time"),new p("reward_per_second"),new p("pending_reward"),new p("count"),new U(16,"mine_diff_ema")],"mine"),je=new z([new de("is_initialized"),Oe,Ee]);function Z(o){return fe(Y.Buffer.from(o.data),je)}async function Le(o){let r=await o.getAccountInfo(Q.publicKey);return Z(r)}function ke(o,r,t,e,n){const i=6e4*n;return o.pipe(D(1e3),R(()=>N(i).pipe(M(0),ge(r.pipe(D(5*1e3))),R(()=>(console.log(">> query mine state"),t.next(!0),o.value.getAccountInfo(Q.publicKey))),T(a=>(t.next(!1),e.next(Date.now()/1e3|0),a?Z(a):null)),pe({delay:.1*i}))))}function Ae(o){return o.pipe(R(t=>{let{start_time:e,last_reward_time:n,pending_reward:i,reward_per_second:s}=t.mine,a=Date.now()/1e3;return a<e?ve(0):N(1e3).pipe(T(u=>u+1),M(0),T(u=>{let f=a+u-n;return(i+f*s)/1e9|0}))}))}let O=window.connectionData;if(!O){let o=new P(new J(X("devnet")));he({}),O={connection:o,wallet:_e()}}const Ie=O.connection,Ue=O.wallet,Te=new S,Re=new P(0),We=new P(!1),Ke=ke(Ie,Te,We,Re,5).pipe(q(1));Ae(Ke).pipe(q(1));export{Ue as $,Le as g};
